$fontlist = @(); $folder = "$env:Windir\fonts\"; $objShell = New-Object -ComObject Shell.Application; $attrList = @();$details = @{ name = 0; fontStyle = 1;}; $objFolder = $objShell.namespace($folder); foreach($file in $objFolder.items()){ $name = $objFolder.getDetailsOf($file, $details.name); $fontStyle = ($objFolder.getDetailsOf($file, $details.fontStyle)).split(); $attrList += ( @{name = $name; fontStyle = $fontStyle; }); };$attrList|ForEach-Object{$n = $_.name; $_.fontstyle |ForEach-Object{$fontlist += "$n-$_" };};set-content "$env:temp\fontlist.json" (ConvertTo-Json($fontlist))
